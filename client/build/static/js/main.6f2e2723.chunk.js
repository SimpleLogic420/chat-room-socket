(this.webpackJsonpclient=this.webpackJsonpclient||[]).push([[0],{155:function(e,t,a){},156:function(e,t,a){},157:function(e,t,a){},158:function(e,t,a){},159:function(e,t,a){"use strict";a.r(t);var n=a(1),c=a.n(n),s=a(44),r=a.n(s),l=a(4),o=a(10),i=a(3),u=Object(n.createContext)({theme:localStorage.getItem("theme")||"theme-auto",setTheme:function(){}}),j=a(5),b=a.n(j),d=a(6),m=a(0);var h=function(e){var t=e.linkName,a=e.link;return Object(m.jsx)("li",{className:"nav__item",children:Object(m.jsx)(o.b,{className:"nav__link",to:a,children:t})})},v=a(12),p=a.n(v),g=c.a.createContext(null),O=function(e){var t=e.children,a=Object(n.useState)(null),c=Object(l.a)(a,2),s=c[0],r=c[1],o=Object(n.useState)(!1),i=Object(l.a)(o,2),u=i[0],j=i[1],h=Object(n.useState)(localStorage.getItem("refresh")||""),v=Object(l.a)(h,2),O=v[0],x=v[1],f=Object(n.useState)(localStorage.getItem("access")||""),N=Object(l.a)(f,2),w=N[0],S=N[1],k=Object(n.useCallback)(function(){var e=Object(d.a)(b.a.mark((function e(t){return b.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,p.a.post("".concat(X,"/api/auth/token"),{token:t});case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),[]);Object(n.useEffect)((function(){Object(d.a)(b.a.mark((function e(){var t,a;return b.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!O||"undefined"===O||u){e.next=16;break}return e.prev=1,e.next=4,k(O);case 4:t=e.sent,a=t.data,S(a.accessToken),localStorage.setItem("access",a.accessToken||""),r(a.email),j(!0),e.next=16;break;case 12:e.prev=12,e.t0=e.catch(1),console.log(e.t0),x(null);case 16:case"end":return e.stop()}}),e,null,[[1,12]])})))()}),[O,k,u]);var A=Object(n.useCallback)(function(){var e=Object(d.a)(b.a.mark((function e(t){var a,n,c,s;return b.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return a=t.email,n=t.password,e.prev=1,e.next=4,p.a.post("".concat(X,"/api/auth/login"),{email:a,password:n});case 4:c=e.sent,s=c.data,x(s.refreshToken),S(s.accessToken),localStorage.setItem("refresh",s.refreshToken),localStorage.setItem("access",s.accessToken),r(a),j(!0),e.next=17;break;case 14:e.prev=14,e.t0=e.catch(1),e.t0.isAxiosError?console.log(e.t0.response.data.error):console.log(e.t0);case 17:case"end":return e.stop()}}),e,null,[[1,14]])})));return function(t){return e.apply(this,arguments)}}(),[]),I=Object(n.useCallback)(function(){var e=Object(d.a)(b.a.mark((function e(t){var a,n,c,s,r;return b.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return a=t.firstName,n=t.lastName,c=t.email,s=t.password,e.prev=1,e.next=4,p.a.post("".concat(X,"/api/auth/sign-up"),{firstName:a,lastName:n,email:c,password:s});case 4:return r=e.sent,e.abrupt("return",r.data);case 8:if(e.prev=8,e.t0=e.catch(1),!e.t0.isAxiosError){e.next=14;break}throw e.t0.response.data.error;case 14:throw console.log(e.t0),Error("Something went bad");case 16:case"end":return e.stop()}}),e,null,[[1,8]])})));return function(t){return e.apply(this,arguments)}}(),[]),E=Object(n.useCallback)(Object(d.a)(b.a.mark((function e(){return b.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,p.a.post("".concat(X,"/api/auth/logout"),{},{headers:{Auth:w||""}});case 2:r(null),j(!1),localStorage.removeItem("refresh"),localStorage.removeItem("access");case 6:case"end":return e.stop()}}),e)}))),[w]);return Object(m.jsx)(g.Provider,{value:{loggedIn:u,email:s,accessToken:w,login:A,logout:E,signUp:I},children:t})};var x=function(){var e=Object(n.useContext)(g),t=null===e||void 0===e?void 0:e.loggedIn,a=null===e||void 0===e?void 0:e.logout,c=Object(i.f)();return Object(m.jsxs)("ul",{className:"nav__list row",children:[Object(m.jsx)(h,{linkName:"Home",link:"/"}),t?[Object(m.jsx)(h,{linkName:"Chat Room",link:"/chat"},"chat"),Object(m.jsx)("button",{className:"default--button",onClick:Object(d.a)(b.a.mark((function e(){return b.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!a){e.next=4;break}return e.next=3,a();case 3:c("/");case 4:case"end":return e.stop()}}),e)}))),style:{backgroundColor:"red",padding:".1em .5em"},children:"Logout"},"logout")]:[Object(m.jsx)(h,{linkName:"Login",link:"/login"},"login"),Object(m.jsx)(h,{linkName:"Sign Up",link:"/sign-up"},"sign-up")]]})};var f=function(e){var t=e.isMobileNavOpen;return Object(m.jsx)("nav",{className:"nav ".concat(t?"nav--visible":""),children:Object(m.jsx)(x,{})})};var N=function(){return Object(m.jsx)(o.b,{to:"/",className:"logo",children:Object(m.jsx)("img",{className:"logo-img",src:"./favicon.ico",alt:"Logo"})})};var w=function(){var e=Object(n.useContext)(u).setTheme,t=Object(n.useState)(localStorage.getItem("theme")||"theme-auto"),a=Object(l.a)(t,2),c=a[0],s=a[1];return Object(m.jsxs)("select",{value:c?c.split("-")[1]:"auto",className:"select-theme",id:"select-theme",onChange:function(t){localStorage.setItem("theme","theme-".concat(t.target.value)),s(t.target.value),e("theme-".concat(t.target.value))},children:[Object(m.jsx)("option",{value:"auto",children:"Auto"}),Object(m.jsx)("option",{value:"light",children:"Light"}),Object(m.jsx)("option",{value:"dark",children:"Dark"})]})};var S=function(){return Object(m.jsxs)("div",{className:"theme",children:[Object(m.jsx)("label",{id:"theme-icon",className:"theme-icon"}),Object(m.jsx)(w,{})]})};a(71);var k=function(e){var t=e.onClick;return Object(m.jsx)("div",{className:"mobile-nav",children:Object(m.jsxs)("button",{className:"nav-toggle",onClick:t,children:[Object(m.jsx)("span",{className:"hamburger"}),Object(m.jsx)("span",{className:"hamburger"}),Object(m.jsx)("span",{className:"hamburger"})]})})};var A=function(){var e=Object(n.useState)(!1),t=Object(l.a)(e,2),a=t[0],c=t[1];return Object(m.jsx)("header",{children:Object(m.jsxs)("div",{className:"header-container row",children:[Object(m.jsxs)("div",{className:"logo-and-theme",children:[Object(m.jsx)(k,{onClick:function(){c(!a)}}),Object(m.jsx)(N,{}),Object(m.jsx)(S,{})]}),Object(m.jsx)(f,{isMobileNavOpen:a})]})})};var I=function(){return Object(m.jsx)("div",{})},E=a(46);a(72);var B=function(e){var t=e.online;return Object(m.jsx)("aside",{className:"chat__aside",children:t.map((function(e,t){return Object(m.jsxs)("div",{className:"aside__user",children:[Object(m.jsx)("div",{className:"online-circle"},"online-circle".concat(t)),Object(m.jsx)("div",{className:"aside__user--email",children:e},"aside__user--email".concat(t))]},"aside__user".concat(t))}))})};var y=function(e){var t=["#e69f73","#db5ec2","#35cd96","#91ab01","#6bcbef","#dfb610","#00b33e","#fd85d4","#e67072","#ba33dc","#c69478","#bd88eb","#8b7add","#fe7c7f","#3bdec3","#e68200"],a=0;if(0===e.length)return"0";for(var n=0;n<e.length;n++)a=e.charCodeAt(n)+((a<<5)-a),a&=a;return t[a=(a%t.length+t.length)%t.length]},M=function(e){var t=e.dir,a=e.email,n=e.content,c=e.timestamp;return Object(m.jsx)("div",{className:"message__container message__container--".concat(t),children:Object(m.jsxs)("div",{className:"chat__message message--".concat(t),children:[Object(m.jsx)("div",{className:"message__user",style:{color:y(a)},children:a}),Object(m.jsx)("div",{className:"message__content",dir:"auto",children:n}),Object(m.jsx)("div",{className:"message__timestamp",children:c})]})})};var T=function(){var e=Object(n.useContext)(g),t=null===e||void 0===e?void 0:e.accessToken,a=Object(n.useState)(""),c=Object(l.a)(a,2),s=c[0],r=c[1],o=function(){var e=Object(d.a)(b.a.mark((function e(a){return b.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return a.preventDefault(),e.next=3,p.a.post("".concat(X,"/api/chat/message"),{content:s},{headers:{auth:t||""}});case 3:r("");case 4:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}();return Object(m.jsx)("div",{className:"send-message",children:Object(m.jsxs)("form",{className:"send-message__form",onSubmit:o,children:[Object(m.jsx)("input",{type:"text",placeholder:"Type a message",value:s,onChange:function(e){return r(e.target.value)},className:"send-message__input"}),Object(m.jsx)("button",{className:"send-message__button",children:Object(m.jsx)("svg",{className:"send-svg",children:Object(m.jsx)("path",{fill:"currentColor",d:"M1.101 21.757L23.8 12.028 1.101 2.3l.011 7.912 13.623 1.816-13.623 1.817-.011 7.912z"})})})]})})};var R=function(e){var t=e.messages,a=Object(n.useContext)(g),c=null===a||void 0===a?void 0:a.email;return Object(m.jsxs)("div",{className:"chat__box--container",children:[Object(m.jsx)("div",{className:"chat__box",children:Object(m.jsx)("div",{className:"chat__box--messages",children:t&&t.map((function(e,t){return Object(m.jsx)(M,{dir:c===e.email?"right":"left",email:e.email,content:e.content,timestamp:new Date(Number(e.timestamp)).toLocaleString()},t)}))})}),Object(m.jsx)(T,{})]})},C=a(45);var Z=function(){var e=Object(n.useContext)(g),t=null===e||void 0===e?void 0:e.loggedIn,a=null===e||void 0===e?void 0:e.accessToken,c=Object(n.useState)([]),s=Object(l.a)(c,2),r=s[0],o=s[1],u=Object(n.useState)([]),j=Object(l.a)(u,2),b=j[0],d=j[1],h=Object(i.f)();return Object(n.useEffect)((function(){t||h("/");var e=new C.EventSourcePolyfill("".concat(X||"","/api/chat/message"),{headers:{"Content-Type":"text/event-stream",auth:a||""}});e.onopen=function(){console.log("connection to stream has been opened")},e.onerror=function(e){console.log("An error has occurred while receiving stream",e)},e.onmessage=function(e){var t=JSON.parse(e.data);t.messages&&o(t.messages),t.newMessage&&o((function(e){return[].concat(Object(E.a)(e),[t.newMessage])})),t.online&&d(t.online)}}),[a,t,h]),Object(m.jsx)("div",{className:"chat",children:Object(m.jsxs)("div",{className:"chat-container row-large",children:[Object(m.jsx)(B,{online:b}),Object(m.jsx)(R,{messages:r})]})})};var D=function(e){var t=e.labelValue,a=e.type,n=e.id,c=e.placeholder,s=e.state,r=e.setState,l=e.handleBlur;return Object(m.jsxs)("div",{className:"form-element",children:[Object(m.jsx)("label",{htmlFor:n,children:t}),Object(m.jsx)("input",{id:n,type:a,placeholder:c,value:s,onChange:function(e){return r(e.target.value)},onBlur:function(e){return l(e)}})]})};a(73);var J=function(e){var t=e.containerClass,a=e.id,n=e.title,c=e.formElements,s=e.submitValue,r=e.handleSubmit;return Object(m.jsx)("div",{className:t,children:Object(m.jsxs)("form",{id:a,className:"form",onSubmit:r,children:[Object(m.jsx)("h2",{children:n}),c.map((function(e,t){var a=e.labelValue,n=e.type,c=e.id,s=e.placeholder,r=e.state,l=e.setState,o=e.handleBlur;return Object(m.jsx)(D,{labelValue:a,type:n,id:c,placeholder:s,state:r,setState:l,handleBlur:o},"".concat(t))})),Object(m.jsx)("div",{className:"form-element",children:Object(m.jsx)("button",{className:"default--button",children:s})})]})})},U=(a(74),a(11)),L=a.n(U);var P=function(){var e=Object(n.useContext)(g),t=null===e||void 0===e?void 0:e.loggedIn,a=null===e||void 0===e?void 0:e.login,c=Object(n.useState)(""),s=Object(l.a)(c,2),r=s[0],o=s[1],u=Object(n.useState)(""),j=Object(l.a)(u,2),h=j[0],v=j[1],p=Object(i.f)();Object(n.useEffect)((function(){t&&p("/")}),[t,p]);var O=[{labelValue:"Email",type:"email",id:"email",placeholder:"Enter Email",state:r,setState:o,handleBlur:function(e){L.a.isEmail(e.target.value)?console.log(""):console.log("Invalid email")}},{labelValue:"Password",type:"password",id:"password",placeholder:"Enter Password",state:h,setState:v,handleBlur:function(e){L.a.isStrongPassword(e.target.value,{minSymbols:0})?console.log(""):console.log("Password must contain at least one uppercase, one lowercase and one number")}}],x=function(){var e=Object(d.a)(b.a.mark((function e(t){return b.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t.preventDefault(),!a){e.next=4;break}return e.next=4,a({email:r,password:h});case 4:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}();return Object(m.jsx)(J,{containerClass:"log-in-container",id:"log-in-form",title:"Log In",formElements:O,submitValue:"Log In",handleSubmit:x})};var W=function(e){var t=e.ghName,a=e.ghLink;return Object(m.jsxs)("a",{className:"copyright-link",href:a,target:"_blank",rel:"noopener noreferrer",children:[Object(m.jsx)("span",{children:t}),Object(m.jsx)("img",{src:"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAAAGXRFWHRTb2Z0d2FyZQBBZG9iZSBJbWFnZVJlYWR5ccllPAAAAyRpVFh0WE1MOmNvbS5hZG9iZS54bXAAAAAAADw/eHBhY2tldCBiZWdpbj0i77u/IiBpZD0iVzVNME1wQ2VoaUh6cmVTek5UY3prYzlkIj8+IDx4OnhtcG1ldGEgeG1sbnM6eD0iYWRvYmU6bnM6bWV0YS8iIHg6eG1wdGs9IkFkb2JlIFhNUCBDb3JlIDUuMy1jMDExIDY2LjE0NTY2MSwgMjAxMi8wMi8wNi0xNDo1NjoyNyAgICAgICAgIj4gPHJkZjpSREYgeG1sbnM6cmRmPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5LzAyLzIyLXJkZi1zeW50YXgtbnMjIj4gPHJkZjpEZXNjcmlwdGlvbiByZGY6YWJvdXQ9IiIgeG1sbnM6eG1wPSJodHRwOi8vbnMuYWRvYmUuY29tL3hhcC8xLjAvIiB4bWxuczp4bXBNTT0iaHR0cDovL25zLmFkb2JlLmNvbS94YXAvMS4wL21tLyIgeG1sbnM6c3RSZWY9Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC9zVHlwZS9SZXNvdXJjZVJlZiMiIHhtcDpDcmVhdG9yVG9vbD0iQWRvYmUgUGhvdG9zaG9wIENTNiAoTWFjaW50b3NoKSIgeG1wTU06SW5zdGFuY2VJRD0ieG1wLmlpZDpFNTE3OEEyQTk5QTAxMUUyOUExNUJDMTA0NkE4OTA0RCIgeG1wTU06RG9jdW1lbnRJRD0ieG1wLmRpZDpFNTE3OEEyQjk5QTAxMUUyOUExNUJDMTA0NkE4OTA0RCI+IDx4bXBNTTpEZXJpdmVkRnJvbSBzdFJlZjppbnN0YW5jZUlEPSJ4bXAuaWlkOkU1MTc4QTI4OTlBMDExRTI5QTE1QkMxMDQ2QTg5MDREIiBzdFJlZjpkb2N1bWVudElEPSJ4bXAuZGlkOkU1MTc4QTI5OTlBMDExRTI5QTE1QkMxMDQ2QTg5MDREIi8+IDwvcmRmOkRlc2NyaXB0aW9uPiA8L3JkZjpSREY+IDwveDp4bXBtZXRhPiA8P3hwYWNrZXQgZW5kPSJyIj8+m4QGuQAAAyRJREFUeNrEl21ojWEYx895TDPbMNlBK46IUiNmPvHBSUjaqc0H8pF5+aDUKPEBqU2NhRQpX5Rv5jWlDIWlMCv7MMSWsWwmb3tpXub4XXWdPHvc9/Gc41nu+nedc7/8r/99PffLdYdDPsvkwsgkTBwsA/PADJCnzX2gHTwBt8Hl7p537/3whn04XoDZDcpBlk+9P8AFcAghzRkJwPF4zGGw0Y9QS0mAM2AnQj77FqCzrtcwB1Hk81SYojHK4DyGuQ6mhIIrBWB9Xm7ug/6B/nZrBHBegrkFxoVGpnwBMSLR9EcEcC4qb8pP14BWcBcUgewMnF3T34VqhWMFkThLJAalwnENOAKiHpJq1FZgI2AT6HZtuxZwR9GidSHtI30jOrbawxlVX78/AbNfhHlomEUJJI89O2MqeE79T8/nk8nMBm/dK576hZgmA3cp/R4l9/UeSxiHLVIlNm4nFfT0bxyuIj7LHRTKai+zdJobwMKzcZSJb0ePV5PKN+BqAAKE47UlMnERELMM3EdYP/yrd+XYb2mOiYBiQ8OQnoRBlXrl9JZix7D1pHTazu4MoyBcnYamqAjIMTR8G4FT8LuhLsexXYYjICBiqhQBvYb6fLZIJCjPypVvaOoVAW2WcasCnL2Nq82xHJNSqlCeFcDshaPK0twkAhosjZL31QYw+1rlMpWGMArl23SBsZZO58F2tlJXmjOXS+s4WGvpMiBJT/I2PInZ6lIs9/hBsNS1hS6BG0DSqmYEDRlCXQrmy50P1oDRKTSegmNbUsA0zDMwRhPJXeCE3vWLPQMvan6X8AgIa1vcR4AkGZkDR4ejJ1UHpsaVI0g2LInpOsNFUud1rhxSV+fzC9Woz2EZkWQuja7/B+jUrgtIMpy9YCW4n4K41YfzRneW5E1KJTe4B2Zq1Q5EHEtj4U3AfEzR5SVY4l7QYQPJdN2as7RKBF0BPZqqH4VgMAMBL8Byxr7y8zCZiDlnOcEKIPmUpgB5Z2ww5RdOiiRiNajUmWda5IG6WbhsyY2fx6m8gLcoJDJFkH219M3We1+cnda93pfycZpIJEL/s/wSYADmOAwAQgdpBAAAAABJRU5ErkJggg==",className:"github-img",alt:""})]})};a(155);var Y=function(){return Object(m.jsx)("footer",{children:Object(m.jsx)("div",{className:"footer-container",children:Object(m.jsxs)("p",{className:"copyright",children:[Object(m.jsx)("span",{children:"\xa9 Copyright 2021"}),Object(m.jsx)(W,{ghLink:"https://github.com/shaharkamay",ghName:"Shahar Kamay"})]})})})};a(156);var G=function(){var e=Object(n.useContext)(g),t=null===e||void 0===e?void 0:e.loggedIn,a=null===e||void 0===e?void 0:e.email;return Object(m.jsx)("div",{className:"hello",children:Object(m.jsxs)("div",{className:"hello-container",children:["Hello,",t?" ".concat(a||"guest"):" guest"]})})};a(157);var _=function(){var e=Object(n.useContext)(g),t=null===e||void 0===e?void 0:e.loggedIn,a=null===e||void 0===e?void 0:e.signUp,c=Object(i.f)(),s=Object(n.useState)(""),r=Object(l.a)(s,2),o=r[0],u=r[1],j=Object(n.useState)(""),h=Object(l.a)(j,2),v=h[0],p=h[1],O=Object(n.useState)(""),x=Object(l.a)(O,2),f=x[0],N=x[1],w=Object(n.useState)(""),S=Object(l.a)(w,2),k=S[0],A=S[1];Object(n.useEffect)((function(){t&&c("/")}),[t,c]);var I=[{labelValue:"First Name",type:"text",id:"first-name",placeholder:"Enter first name",state:o,setState:u,handleBlur:function(e){L.a.isAlpha(e.target.value)?console.log(""):console.log("Invalid name")}},{labelValue:"Last Name",type:"text",id:"last-name",placeholder:"Enter last name",state:v,setState:p,handleBlur:function(e){L.a.isAlpha(e.target.value)?console.log(""):console.log("Invalid name")}},{labelValue:"Email",type:"email",id:"email",placeholder:"Enter Email",state:f,setState:N,handleBlur:function(e){L.a.isEmail(e.target.value)?console.log(""):console.log("Invalid email")}},{labelValue:"Password",type:"password",id:"password",placeholder:"Enter Password",state:k,setState:A,handleBlur:function(e){L.a.isStrongPassword(e.target.value,{minSymbols:0})?console.log(""):console.log("Password must contain at least one uppercase, one lowercase and one number")}}],E=function(){var e=Object(d.a)(b.a.mark((function e(t){return b.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t.preventDefault(),!a){e.next=6;break}return e.next=4,a({firstName:o,lastName:v,email:f,password:k});case 4:e.sent.isSignedUp&&c("/login");case 6:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}();return Object(m.jsx)(J,{containerClass:"sign-up-container",id:"sign-up-form",title:"Sign Up",formElements:I,submitValue:"Sign Up",handleSubmit:E})};var V=function(){var e=Object(n.useState)(localStorage.getItem("theme")||"theme-auto"),t=Object(l.a)(e,2),a=t[0],c=t[1];return Object(m.jsx)(O,{children:Object(m.jsx)(u.Provider,{value:{theme:a,setTheme:c},children:Object(m.jsx)("div",{className:"App ".concat(a),children:Object(m.jsxs)(o.a,{children:[Object(m.jsx)(A,{}),Object(m.jsx)(G,{}),Object(m.jsx)("main",{children:Object(m.jsxs)(i.c,{children:[Object(m.jsx)(i.a,{path:"/",element:Object(m.jsx)(I,{})}),Object(m.jsx)(i.a,{path:"/chat",element:Object(m.jsx)(Z,{})}),Object(m.jsx)(i.a,{path:"/login",element:Object(m.jsx)(P,{})}),Object(m.jsx)(i.a,{path:"/sign-up",element:Object(m.jsx)(_,{})}),Object(m.jsx)(i.a,{path:"*",element:Object(m.jsx)(I,{})})]})}),Object(m.jsx)(Y,{})]})})})})};a(158);r.a.hydrate(Object(m.jsx)(c.a.StrictMode,{children:Object(m.jsx)(V,{})}),document.getElementById("root"));var Q="localhost"===window.location.hostname?"http://localhost:8080":"",X=t.default=Q},71:function(e,t,a){},72:function(e,t,a){},73:function(e,t,a){},74:function(e,t,a){}},[[159,1,2]]]);
//# sourceMappingURL=main.6f2e2723.chunk.js.map